# CI Failure Analysis

The CI pipeline failed on the `test_restart_closed_sessions_relaunches` test in `tests/cli/commands/coordinator/test_vscodeclaude.py`. The failure occurs because the test calls `restart_closed_sessions()` which internally invokes `is_session_stale()`. This function instantiates an `IssueManager` object (at `vscodeclaude.py:1586`) to check whether an issue's status has changed. The `IssueManager` constructor inherits from `BaseGitHubManager`, which requires a valid GitHub token from the user configuration. Since no GitHub token is available in the CI environment (and the test doesn't mock this dependency), the constructor raises a `ValueError`: "GitHub token not found."

The files involved in this failure are `src/mcp_coder/cli/commands/coordinator/vscodeclaude.py` (specifically the `is_session_stale()` function at line 1586 and `restart_closed_sessions()` at line 1460), `src/mcp_coder/utils/github_operations/base_manager.py` (the `BaseGitHubManager.__init__` method at line 140), and the test file `tests/cli/commands/coordinator/test_vscodeclaude.py`.

To fix this, the test needs to mock the `coordinator.IssueManager` instantiation within the `is_session_stale()` function, or mock the `get_config_values` call to return a fake GitHub token. The `is_session_stale()` function uses `_get_coordinator().IssueManager()` to create the manager, so the mock should be applied to the coordinator's `IssueManager` attribute. Alternatively, the test could patch `mcp_coder.utils.user_config.get_config_values` to return a mock token value for the `("github", "token")` key, which would allow `BaseGitHubManager.__init__` to proceed without raising an error.