# CI Failure Analysis

The unit tests failed with 8 test failures across two main categories: issue cache handling and GitHub token validation in test setup. The failures indicate that recent changes to how closed issues are handled have broken existing test assumptions and introduced improper token validation during test initialization.

The first category of failures (5 tests) relates to closed issue handling. Tests in `tests/utils/github_operations/test_issue_cache.py` show that when issues are marked as closed, they are being filtered out earlier than expected with the log message "Issue #123: no longer exists in repository". The tests expect these issues to still be present in results for cache validation, but the new closed issue logic is removing them prematurely. Similarly, tests in `tests/workflows/vscodeclaude/test_closed_issues_integration.py` expect closed issues to appear in status displays with a "(Closed)" marker, but instead they are being filtered out entirely before display with the log "Skipping closed issue #414 with missing folder".

The second category of failures (3 tests) in `tests/workflows/vscodeclaude/test_orchestrator_sessions.py` shows that the `restart_closed_sessions()` function is attempting to initialize an `IssueManager` during test setup, which triggers GitHub token validation. The error "ValueError: GitHub token not found. Configure it in ~/.mcp_coder/config.toml or set GITHUB_TOKEN environment variable" occurs in `_build_cached_issues_by_repo()` at line 865 of `orchestrator.py`, which creates an IssueManager that requires authentication even in test contexts where it should be mocked.

To fix these issues, changes are needed in several areas: (1) The issue cache logic in `mcp_coder/utils/github_operations/issues/cache.py` around line 247 needs to distinguish between truly non-existent issues and closed issues that should remain in cache for testing, (2) The status display logic in `mcp_coder/workflows/vscodeclaude/status.py` around line 299 needs to show closed issues rather than skipping them when folders are missing, and (3) The `_build_cached_issues_by_repo()` helper in `mcp_coder/workflows/vscodeclaude/orchestrator.py` needs to be refactored to avoid requiring GitHub tokens during test initialization, possibly by accepting pre-built issue managers or by making token validation optional in test contexts.