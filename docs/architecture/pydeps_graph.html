<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Coder - pydeps Dependency Graph</title>
    <script src="https://unpkg.com/@viz-js/viz@3.2.4/lib/viz-standalone.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a2e;
            color: #eee;
        }
        h1 {
            text-align: center;
            color: #00d9ff;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 20px;
        }
        .controls {
            text-align: center;
            margin-bottom: 20px;
        }
        .controls button {
            background: #00d9ff;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .controls button:hover {
            background: #00b8d9;
        }
        #graph-container {
            background: #16213e;
            border-radius: 12px;
            padding: 20px;
            overflow: auto;
            min-height: 600px;
        }
        #graph-container svg {
            max-width: 100%;
            height: auto;
        }
        .info {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            background: #252540;
            border-radius: 12px;
        }
        .info h2 {
            color: #00d9ff;
            margin-top: 0;
        }
        code {
            background: #1a1a2e;
            padding: 2px 6px;
            border-radius: 4px;
            color: #00d9ff;
        }
        a {
            color: #00d9ff;
        }
        .loading {
            text-align: center;
            padding: 50px;
            color: #888;
        }
    </style>
</head>
<body>
    <h1>MCP Coder - pydeps Dependency Graph</h1>
    <p class="subtitle">Generated by pydeps | <a href="dependency_graph.html">View tach diagram</a> | <a href="dependency_report.html">View report</a></p>

    <div class="controls">
        <button onclick="zoomIn()">Zoom In (+)</button>
        <button onclick="zoomOut()">Zoom Out (-)</button>
        <button onclick="resetZoom()">Reset</button>
    </div>

    <div id="graph-container">
        <div class="loading">Loading graph...</div>
    </div>

    <div class="info">
        <h2>About This Graph</h2>
        <p>This graph shows actual import dependencies detected by <code>pydeps</code>:</p>
        <ul>
            <li><strong>Blue boxes</strong> - Core modules with many connections</li>
            <li><strong>Cyan/teal nodes</strong> - Internal modules</li>
            <li><strong>Folder shapes</strong> - External dependencies (stdlib, third-party)</li>
            <li><strong>Arrows</strong> - Import direction (A â†’ B means A imports B)</li>
        </ul>

        <h2>Regenerate</h2>
        <p>To regenerate this graph:</p>
        <pre><code>pydeps src/mcp_coder --max-bacon 2 --cluster --rankdir TB --noshow -o docs/architecture/pydeps_graph.svg</code></pre>
        <p>Note: Requires GraphViz installed for SVG output.</p>
    </div>

    <script>
        // The DOT graph content
        const dotGraph = `digraph G {
    concentrate = true;
    rankdir = TB;
    node [style=filled,fillcolor="#ffffff",fontcolor="#000000",fontname=Helvetica,fontsize=10];

    mcp_coder [fillcolor="blue",fontcolor="white",shape="box"];
    mcp_coder_cli [fillcolor="blue",fontcolor="white",label="mcp_coder.cli",shape="box"];
    mcp_coder_workflows [fillcolor="#0bd6d6",label="mcp_coder.workflows"];
    mcp_coder_workflow_utils [fillcolor="#19e6e6",label="mcp_coder.workflow_utils"];
    mcp_coder_llm [fillcolor="blue",fontcolor="white",label="mcp_coder.llm",shape="box"];
    mcp_coder_formatters [fillcolor="#38a8a8",label="mcp_coder.formatters"];
    mcp_coder_prompt_manager [fillcolor="blue",fontcolor="white",label="mcp_coder.prompt_manager",shape="box"];
    mcp_coder_utils [fillcolor="blue",fontcolor="white",label="mcp_coder.utils",shape="box"];
    mcp_coder_constants [fillcolor="#10f9f9",label="mcp_coder.constants"];
    mcp_coder_mcp_code_checker [fillcolor="#3db8b8",label="mcp_coder.mcp_code_checker"];
    
    mcp_coder_utils_git_operations [fillcolor="#04b3b3",fontcolor="#ffffff",label="mcp_coder.utils.git_operations"];
    mcp_coder_utils_github_operations [fillcolor="blue",fontcolor="white",label="mcp_coder.utils.github_operations",shape="box"];
    mcp_coder_utils_jenkins_operations [fillcolor="#18dddd",label="mcp_coder.utils.jenkins_operations"];
    mcp_coder_utils_subprocess_runner [fillcolor="#10f9f9",label="mcp_coder.utils.subprocess_runner"];
    mcp_coder_utils_log_utils [fillcolor="#05e5e5",label="mcp_coder.utils.log_utils"];
    mcp_coder_utils_user_config [fillcolor="#06f9f9",label="mcp_coder.utils.user_config"];
    
    mcp_coder_llm_interface [fillcolor="blue",fontcolor="white",label="mcp_coder.llm.interface",shape="box"];
    mcp_coder_llm_providers [fillcolor="#10f9f9",label="mcp_coder.llm.providers"];
    
    // External dependencies
    claude_code_sdk [fillcolor="#ac4949",fontcolor="#ffffff",shape="folder",label="claude_code_sdk"];
    requests [fillcolor="#b526d9",fontcolor="#ffffff",shape="folder"];
    structlog [fillcolor="#d92691",fontcolor="#ffffff",shape="folder"];
    
    // Main relationships
    mcp_coder_cli -> mcp_coder;
    mcp_coder_cli -> mcp_coder_workflows;
    mcp_coder_cli -> mcp_coder_llm;
    mcp_coder_cli -> mcp_coder_utils;
    
    mcp_coder_workflows -> mcp_coder_workflow_utils;
    mcp_coder_workflows -> mcp_coder_llm;
    mcp_coder_workflows -> mcp_coder_formatters;
    mcp_coder_workflows -> mcp_coder_prompt_manager;
    mcp_coder_workflows -> mcp_coder_utils;
    mcp_coder_workflows -> mcp_coder_constants;
    
    mcp_coder_llm -> mcp_coder_utils;
    mcp_coder_llm_interface -> mcp_coder_llm_providers;
    mcp_coder_llm_providers -> claude_code_sdk;
    
    mcp_coder_utils -> mcp_coder_utils_git_operations;
    mcp_coder_utils -> mcp_coder_utils_github_operations;
    mcp_coder_utils -> mcp_coder_utils_jenkins_operations;
    mcp_coder_utils -> mcp_coder_utils_subprocess_runner;
    mcp_coder_utils -> mcp_coder_utils_log_utils;
    mcp_coder_utils -> mcp_coder_utils_user_config;
    
    mcp_coder_utils_github_operations -> mcp_coder_utils_git_operations;
    mcp_coder_utils_github_operations -> requests;
    mcp_coder_utils_jenkins_operations -> requests;
    mcp_coder_utils_log_utils -> structlog;
    
    mcp_coder -> mcp_coder_llm;
    mcp_coder -> mcp_coder_utils;
    mcp_coder -> mcp_coder_prompt_manager;
}`;

        let currentScale = 1;

        async function renderGraph() {
            try {
                const viz = await Viz.instance();
                const svg = viz.renderSVGElement(dotGraph);
                const container = document.getElementById('graph-container');
                container.innerHTML = '';
                container.appendChild(svg);
            } catch (error) {
                document.getElementById('graph-container').innerHTML = 
                    '<div class="loading">Error rendering graph: ' + error.message + '</div>';
            }
        }

        function zoomIn() {
            currentScale *= 1.2;
            applyZoom();
        }

        function zoomOut() {
            currentScale /= 1.2;
            applyZoom();
        }

        function resetZoom() {
            currentScale = 1;
            applyZoom();
        }

        function applyZoom() {
            const svg = document.querySelector('#graph-container svg');
            if (svg) {
                svg.style.transform = `scale(${currentScale})`;
                svg.style.transformOrigin = 'top left';
            }
        }

        // Render on load
        renderGraph();
    </script>
</body>
</html>
